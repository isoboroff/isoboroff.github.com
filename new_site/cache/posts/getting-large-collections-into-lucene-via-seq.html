<p><html><body><p>I had a problem while setting up my indexing job for the ClueWeb09 collection.?? I wanted to do it from a MapReduce job: take each document, break it down into indexable chunks (title, URL, metadata, text, anchors) keyed by URL, sort around to accumulate the anchors for each document, then dump to an IndexWriter writing to local storage in the reduce phase.</p><p></p> Great idea, only Lucene would get into long periods of juggling files in the FSDirectory, and the reduce jobs would time out.?? My cluster would run 36 reduce jobs, and each one at the end (using the different process I'm about to describe) produced a 55GB index of around 14 million documents.?? Maybe this was expected, maybe not.<p></p> So here's what I did instead: the indexable chunks are sorted down in the reduce phase and written out to LZO-compressed SequenceFiles.?? Here's how it works... this code is too closely tied up in our larger IR system to easily post the code up to a repository, so you'll have to make do with snippets and pseudocode this time around.<p></p> The Mapper job takes each document, parses out the headers, text, anchors, bacon, and coffee, and puts each one into what I call a ParseTuple.?? A ParseTuple is a (key, value) pair.?? Note that this is a simple WritableComparable.<p></p> <span style="font-family: courier new,monospace;">import java.io.IOException;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.io.DataInput;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.io.DataOutput;</span><p></p><span style="font-family: courier new,monospace;">import org.apache.hadoop.io.Text;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import org.apache.hadoop.io.WritableComparable;</span><p></p><span style="font-family: courier new,monospace;">public class ParseTuple implements WritableComparable&lt;ParseTuple&gt; {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? protected String label;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? protected String data;</span><p></p> <span style="font-family: courier new,monospace;">?????? public ParseTuple() {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? label = null;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? data = null;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p> <span style="font-family: courier new,monospace;">?????? public ParseTuple(String a, String b) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? label = a;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? data = b;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p> <span style="font-family: courier new,monospace;">?????? public void write(DataOutput out) throws IOException {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? Text.writeString(out, label);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? Text.writeString(out, data);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p> <span style="font-family: courier new,monospace;">?????? public void readFields(DataInput in) throws IOException {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? label = Text.readString(in);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? data = Text.readString(in);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p> <span style="font-family: courier new,monospace;">?????? public static ParseTuple read(DataInput in) throws IOException {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? ParseTuple pt = new ParseTuple();</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? pt.readFields(in);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? return pt;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p> <span style="font-family: courier new,monospace;">?????? public int compareTo(ParseTuple other) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? if (label.equals("ptext"))</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? return -1;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? else if (other.label.equals("ptext"))</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? return 1;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? else</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? return label.compareTo(other.label);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p> <span style="font-family: courier new,monospace;">?????? public String toString() {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? return new String(label + ":" + data);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">}</span><p></p>The Mapper class as you know emits (key, value) pairs.?? In this case, the mapper maps documents to (URL, ParseTuple) pairs.?? The keys inside each ParseTuple are used to identify how I want each tuple indexed - what Lucene Field, essentially, the data should go into.<p></p> The Reducer is going to compile all the ParseTuples for a given URL into what I call a DocBits.?? Again, it's a simple serializable Map, so that the reducer can emit a single value for each URL.?? Here's DocBits:<p></p> <span style="font-family: courier new,monospace;">import java.io.IOException;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.io.DataInput;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.io.DataOutput;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.util.HashMap;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.util.Map;</span><p></p><span style="font-family: courier new,monospace;">import org.apache.hadoop.io.Text;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import org.apache.hadoop.io.Writable;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import org.apache.hadoop.mapreduce.Reducer;</span><p></p> <span style="font-family: courier new,monospace;">public class DocBits implements Writable {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? protected HashMap&lt;String, String&gt; map;</span><p></p> <span style="font-family: courier new,monospace;">?????? public DocBits() {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? map = new HashMap();</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p><span style="font-family: courier new,monospace;">?????? public void add(String k, String v) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? map.put(k, v);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p> <span style="font-family: courier new,monospace;">?????? public void add(ParseTuple p) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? map.put(p.label, p.data);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p><span style="font-family: courier new,monospace;">?????? public void write(DataOutput out) throws IOException {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? for (Map.Entry&lt;String, String&gt; e : map.entrySet()) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? Text.writeString(out, e.getKey());</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? Text.writeString(out, e.getValue());</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? }</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? Text.writeString(out, "EOD");</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p> <span style="font-family: courier new,monospace;">?????? public void readFields(DataInput in) throws IOException {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? while (true) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? String k = Text.readString(in);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? if (k.equals("EOD"))</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????????????? break;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? String v = Text.readString(in);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? ?????????????? map.put(k, v);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? }</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p><span style="font-family: courier new,monospace;">?????? public static DocBits read(DataInput in) throws IOException {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? DocBits db = new DocBits();</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? db.readFields(in);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? return db;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">}</span><p></p>The Reducer is very simple:<p></p>i<span style="font-family: courier new,monospace;">mport java.io.IOException;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.util.Map;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.util.HashMap;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import java.util.regex.Pattern;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">???????????????? </span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import org.apache.hadoop.io.Text;</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">import org.apache.hadoop.mapreduce.Reducer;</span><p></p> <span style="font-family: courier new,monospace;">public class ReduceParseTuplesToDocBits</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? extends Reducer&lt;Text, ParseTuple, Text, DocBits&gt; {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? </span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? public void reduce(Text key, Iterable&lt;ParseTuple&gt; values, </span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">???????????????????????????????????????????? Context context)</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? throws IOException, InterruptedException {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? </span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? DocBits doc = new DocBits();</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? StringBuilder anchors = new StringBuilder(65536);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? StringBuilder title = new StringBuilder(8096);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? boolean have_parsed_doc = false;</span><p></p><span style="font-family: courier new,monospace;">?????????????? doc.add("url", key.toString());</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? context.setStatus(key.toString());</span><p></p><span style="font-family: courier new,monospace;">?????????????? for (ParseTuple t: values) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????? if (t.label.equals("ptext")) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????????????? doc.add("ptext", t.data);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????????????? have_parsed_doc = true;</span><p></p><span style="font-family: courier new,monospace;">?????????????????????? } else if (t.label.equals("title"))</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????????????? title.append(t.data).append(" ");</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????? </span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????? else if (t.label.equals("anchor") &amp;&amp; anchors.length() &lt; 65536)</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????????????? anchors.append(t.data).append(" ");</span><p></p> <span style="font-family: courier new,monospace;">?????????????????????? else</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????????????? doc.add(t);</span><p></p> <span style="font-family: courier new,monospace;">?????????????????????? context.progress();</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? }</span><p></p> <span style="font-family: courier new,monospace;">?????????????? if (have_parsed_doc) {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????? if (anchors.length() &gt; 0)</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????????????? doc.add("anchor", anchors.toString());</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????? if (title.length() &gt; 0)</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????????????????????? doc.add("title", title.toString());</span><p></p><span style="font-family: courier new,monospace;">?????????????????????? context.write(key, doc);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? }</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">}</span><p></p>The reducer has to be a little clever, because the Mapper will emit anchortext for documents that aren't in the collection.?? We could actually index that if we wanted to, but we don't, since our job is only to search within the collection.<p></p> The main class that runs the job sets up the Mapper, Reducer, and the compressed SequenceFile:<p></p><span style="font-family: courier new,monospace;">???? public int run(String[] args) throws Exception {</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? Configuration conf = getConf();</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;"></span><span style="font-family: courier new,monospace;">?????????????? Job job = new Job(conf, "p3l.MapReduceIndexer");</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">???????????????? </span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? job.setJarByClass(this.getClass());</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? LOG.info("Jar is " + job.getJar());</span><p></p><span style="font-family: courier new,monospace;">?????????????? job.setMapperClass(MapWebDocToParseTuple.class);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? job.setMapOutputKeyClass(Text.class);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? job.setMapOutputValueClass(ParseTuple.class);</span><p></p> <span style="font-family: courier new,monospace;">?????????????? job.setReducerClass(ReduceParseTuplesToDocBits.class);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? job.setOutputKeyClass(Text.class);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? job.setOutputValueClass(DocBits.class);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">???????????????????????????????? </span><span style="font-family: courier new,monospace;"></span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;"></span><span style="font-family: courier new,monospace;">?????????????? job.setInputFormatClass(</span><span style="font-family: courier new,monospace;">ClueWebInputFormat.class;</span><span style="font-family: courier new,monospace;">); // default</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? job.setOutputFormatClass(SequenceFileOutputFormat.class);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">???????????????? </span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? FileInputFormat.setInputPaths(job, new Path(args[1]));</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? SequenceFileOutputFormat.setOutputPath(job, new Path(args[2]));</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? SequenceFileOutputFormat.setCompressOutput(job, true);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? SequenceFileOutputFormat.setOutputCompressorClass(job, com.hadoop.compression.lzo.LzoCodec.class);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? SequenceFileOutputFormat.setOutputCompressionType(job, SequenceFile.CompressionType.BLOCK);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">???????????????? </span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? // job.submit();</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????????????? return (job.waitForCompletion(true) ? 0 : 1);</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">?????? }</span><p></p>So at the end of this job, each Reducer has created a 26GB LZO-compressed SequenceFile ready to index:<p></p> <span style="font-family: courier new,monospace;">[soboroff@node1 ~]$ hadoop fs -ls clue</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">Found 38 items</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop???????????????????? 0 2011-02-08 14:09 /user/soboroff/clue/_SUCCESS</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">drwxrwxr-x???? - soboroff hadoop???????????????????? 0 2011-02-07 15:38 /user/soboroff/clue/_logs</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26327668533 2011-02-08 08:18 /user/soboroff/clue/part-r-00000</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26339468375 2011-02-08 08:18 /user/soboroff/clue/part-r-00001</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26330501868 2011-02-08 08:17 /user/soboroff/clue/part-r-00002</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26366091781 2011-02-08 08:14 /user/soboroff/clue/part-r-00003</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26321214072 2011-02-08 08:16 /user/soboroff/clue/part-r-00004</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26349081494 2011-02-08 08:18 /user/soboroff/clue/part-r-00005</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26343308176 2011-02-08 08:28 /user/soboroff/clue/part-r-00006</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26352600382 2011-02-08 08:24 /user/soboroff/clue/part-r-00007</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26321726649 2011-02-08 08:18 /user/soboroff/clue/part-r-00008</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26339094476 2011-02-08 08:10 /user/soboroff/clue/part-r-00009</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26321564045 2011-02-08 08:16 /user/soboroff/clue/part-r-00010</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26343854112 2011-02-08 08:10 /user/soboroff/clue/part-r-00011</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26315754762 2011-02-08 08:15 /user/soboroff/clue/part-r-00012</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26346819081 2011-02-08 08:18 /user/soboroff/clue/part-r-00013</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26364417290 2011-02-08 08:10 /user/soboroff/clue/part-r-00014</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26345720864 2011-02-08 08:15 /user/soboroff/clue/part-r-00015</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26325886676 2011-02-08 08:19 /user/soboroff/clue/part-r-00016</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26352366823 2011-02-08 08:16 /user/soboroff/clue/part-r-00017</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26363877289 2011-02-08 08:10 /user/soboroff/clue/part-r-00018</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26346838673 2011-02-08 08:23 /user/soboroff/clue/part-r-00019</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26334634232 2011-02-08 08:18 /user/soboroff/clue/part-r-00020</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26338242486 2011-02-08 08:15 /user/soboroff/clue/part-r-00021</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26333691832 2011-02-08 08:11 /user/soboroff/clue/part-r-00022</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26351824723 2011-02-08 08:13 /user/soboroff/clue/part-r-00023</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26340649075 2011-02-08 08:14 /user/soboroff/clue/part-r-00024</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26348830107 2011-02-08 08:11 /user/soboroff/clue/part-r-00025</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26341221269 2011-02-08 08:17 /user/soboroff/clue/part-r-00026</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26318480301 2011-02-08 08:09 /user/soboroff/clue/part-r-00027</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26314900021 2011-02-08 08:22 /user/soboroff/clue/part-r-00028</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26335481459 2011-02-08 08:16 /user/soboroff/clue/part-r-00029</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26329189695 2011-02-08 08:22 /user/soboroff/clue/part-r-00030</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26347416304 2011-02-08 08:14 /user/soboroff/clue/part-r-00031</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26340982688 2011-02-08 08:27 /user/soboroff/clue/part-r-00032</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26327061702 2011-02-08 08:18 /user/soboroff/clue/part-r-00033</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26331125728 2011-02-08 08:12 /user/soboroff/clue/part-r-00034</span><br style="font-family: courier new,monospace;"><span style="font-family: courier new,monospace;">-rw-r--r--???? 3 soboroff hadoop 26328859269 2011-02-08 08:09 /user/soboroff/clue/part-r-00035</span><p></p> And lastly, I have a stand-alone application which uses a SequenceFile.Reader to read each DocBits and build it into a Lucene Document, which gets passed on to an IndexWriter.?? This application doesn't run under MapReduce, so I don't worry about Lucene timeouts.?? Also, I have the entire collection preparsed, so I can easily shove those bits into HBase or any other system I want to.</body></html></p>